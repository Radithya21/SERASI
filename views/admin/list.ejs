<!DOCTYPE html>
<html>

<head>
    <title>
        <%= title %>
    </title>
    <link rel='stylesheet' href='/stylesheets/output.css' />
</head>

<body class="bg-gray-100 font-sans antialiased">
    <div class="flex">
        <% include ../partials/sidebarAdmin %> <!-- Menambahkan sidebar -->
            <div class="flex-1 p-4">
                <div class="container mx-auto bg-white p-6 rounded-lg shadow-md mt-8">
                    <h1 class="text-3xl font-bold mb-6 text-gray-800">
                        <%= title %>
                    </h1>

                    <% if (success_msg && success_msg.length> 0) { %>
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4"
                            role="alert">
                            <span class="block sm:inline">
                                <%= success_msg %>
                            </span>
                        </div>
                        <% } %>

                            <% if (error_msg && error_msg.length> 0) { %>
                                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
                                    role="alert">
                                    <span class="block sm:inline">
                                        <%= error_msg %>
                                    </span>
                                </div>
                                <% } %>

                                    <div class="flex justify-between items-center mb-6">
                                        <a href="/pengguna/add"
                                            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300">
                                            Tambah Pengguna Baru
                                        </a>
                                        <a href="/pengguna/stats"
                                            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300 ml-4">
                                            Lihat Statistik Kehadiran
                                        </a>
                                    </div>

                                    <% if (pengguna.length> 0) { %>
                                        <div class="overflow-x-auto">
                                            <table
                                                class="min-w-full bg-white border border-gray-200 rounded-md overflow-hidden">
                                                <thead class="bg-gray-100">
                                                    <tr>
                                                        <th
                                                            class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-600">
                                                            Nama</th>
                                                        <th
                                                            class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-600">
                                                            Email</th>
                                                        <th
                                                            class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-600">
                                                            Role</th>
                                                        <th
                                                            class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-600">
                                                            Status</th>
                                                        <th
                                                            class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-600">
                                                            Aksi</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% pengguna.filter(user=> user.role !== 'admin').forEach(user => {
                                                        %>
                                                        <tr class="hover:bg-gray-50 transition duration-150">
                                                            <td class="py-3 px-4 border-b text-gray-700">
                                                                <%= user.nama %>
                                                            </td>
                                                            <td class="py-3 px-4 border-b text-gray-700">
                                                                <%= user.email %>
                                                            </td>
                                                            <td class="py-3 px-4 border-b text-gray-700 capitalize">
                                                                <%= user.role %>
                                                            </td>
                                                            <td class="py-3 px-4 border-b text-gray-700 capitalize">
                                                                <%= user.status %>
                                                            </td>
                                                            <td class="py-3 px-4 border-b text-gray-700">
                                                                <a href="/pengguna/edit/<%= user.id_pengguna %>"
                                                                    class="text-indigo-600 hover:text-indigo-800 text-sm font-medium mr-3">Edit</a>
                                                                <form action="/pengguna/delete/<%= user.id_pengguna %>"
                                                                    method="POST" class="inline-block"
                                                                    onsubmit="return confirm('Apakah Anda yakin ingin menghapus pengguna ini? Tindakan ini tidak dapat dibatalkan.');">
                                                                    <button type="submit"
                                                                        class="text-red-600 hover:text-red-800 text-sm font-medium">Hapus</button>
                                                                </form>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                        <% } else { %>
                                            <p class="text-gray-600 text-center py-8">Belum ada pengguna terdaftar.</p>
                                            <% } %>
                </div>
            </div>
    </div>
</body>

</html>